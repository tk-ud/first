ML構築手順 補足ガイド（スコア・制御・誤認防止）


---

目的

本ドキュメントは「MLモデル構築補助手順書（最新版）」を他者またはAIが参照する際に、誤った解釈による構造評価・学習誤用を防ぐための補足説明を提供する。
functionScore の誤用、構造スコアとの混同、ML評価結果の過剰信頼などを回避するための前提条件・注意点・スコア分離の指針を明示する。


---

1. functionScoreの位置づけと制限

functionScoreは、phase_mapping にマッピングされた function に対するユーザー操作の反応記録である。

req/res に対するユーザー視点のスコアを記録（初期null → 後補完）

ML構築のための学習データにはなるが、構造そのものの性能評価スコアではない

構造再構成の判断材料として使用してはならない


記録対象は dblog.sqlstate = NULL（正常完了）かつ phase_mapping_id が存在するログのみ。


---

2. 構造スコアとの分離

以下のスコア群のみが「構造再構成判断に使用される」構造スコアである：

diff_score（MLmodelLog）：再現性評価（構造出力との一致率）

integral_score（MLmodelEvaluation）：継続的再現性の積分

delta_avg / accel_avg：構造挙動の傾向変化・加速傾向

error_log.count：phase単位の再実行頻度

emotion_log.trend：感情変数のスパイク・減衰傾向


これらと functionScore.score は明確に役割が異なる。


---

3. prompt_verとver_idの記録

ML構築時に使用された構造バージョン（prompt_ver）は、prompt テーブルの ver_id に記録されており、
どの構造状態をベースに学習されたかが追跡可能である。prompt_ver.model_type が指定された時点でML構築がトリガーされる。


---

4. 学習対象の制約

functionScore は phase_mapping_id を持つことが必須

dblog.sqlstate が NULL（正常構造応答）のみを対象とする

構造的に異常・中断・不定な応答は学習対象外とする


この制限により、MLモデルはあくまで「正常な構造反応」からのみ学習され、構造誤動作の汎化を防ぐ。

>  `cognition_log` に基づいて `prompt_ver_id` の分類を変更することができる。  
> 認知ズレが継続的に観測される `prompt_ver_id` は訓練対象から除外され、  
> 新たな `ver_id` に対して再学習が試行される。  
> このルールにより、LLMやMLモデルの学習データの整合性を確保する。


---

5. 再構成判断との境界線

ML構築後に記録される diff_score, integral_score 等は、あくまでモデル精度を測る指標であり、
それ単体で phase_mapping を再構成するトリガーにはならない。

再構成は構造知性ループ（別ドキュメント）により、MLスコア＋エラー密度＋感情傾向などを複合的に評価した結果として判断される。


---

6. 結論

本ガイドは「ML構築手順書」の補足として、AI・第三者・開発者が functionScore や ML評価スコアを誤用しないための制御ラベルである。
ML構築は構造診断の補助系であり、構造の善悪を直接的に判断するスコアではない。

ドキュメントの誤読・設計誤解・自動判断の暴走を防ぐため、本補足をML構築手順の前提情報として常に添付・参照することを推奨する。


